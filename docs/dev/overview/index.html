<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Travis CI: Overview</title>
    <link rel="stylesheet" type="text/css" href="/style.css" media="screen">
    <link rel="alternate" type="application/rss+xml" href="/blog.xml">
  </head>
  <body>
    <div id="navigation">
      <div class="wrapper">
        <a href="http://travis-ci.org" id="logo">travis-ci<span>.org</span></a>
        <ul>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="/docs/">Documentation</a></li>
          <li class="right"><a href="http://travis-ci.org">go to travis-ci.org &rarr;</a></li>
        </ul>
      </div>
    </div>

    <div id="header">
      <div class="wrapper">
        <!--
        <div class="language-switcher">
          <nav>
          <span>Languages:</span>
          <ul>
            <li><a href="/" class="selected">en</a></li>
            <li><a href="/fr/">fr</a></li>
          </ul>
          </nav>
        </div>
        -->
        <h1 class="riddle"><a href="/" title="Travis">Travis CI</a></h1>
        <p>A distributed build system for the open source community.</p>
      </div><!-- /.wrapper -->
    </div><!-- /#header -->

    <div id="content">
      <div class="wrapper">
        <div class="pad">
          <div id="main">
            
              <h2>Overview</h2>
            

            <h2 id="what-this-guide-covers">What This Guide Covers</h2>

<p>This guide explains what applications, libraries, tools and practices make travis-ci.org run. It briefly outlines
why each part of the system works the way it does and what upsides and downsides it entails. It intentionally leaves out many
details and should be considered a high level overview.</p>

<h2 id="applications">Applications</h2>

<p>Travis CI v3 (deployed in November 2011) consists of 4 key applications:</p>

<ul>
  <li>Travis Hub</li>
  <li>Travis Server</li>
  <li>Travis Worker</li>
  <li>Travis Boxes</li>
</ul>

<p>that communicate primarily over <a href="http://rubyamqp.info/articles/amqp_9_1_model_explained/">AMQP 0.9.1</a>. Some of them also share
our main database but in a way isolates updates from read requests.</p>

<h3 id="one-day-in-life-of-build-request">One Day in Life of Build Request</h3>

<h4 id="early-morning">Early Morning</h4>

<p>When external <code>Build Request</code> (currently, push notification from GitHub) comes in via HTTP, it is handled by <code>Travis Server</code>. If there is no existing builds history for
the project, it is initialized. <code>Travis Server</code> then emits a <code>configuration task</code> message and is done with its part.</p>

<p><code>Configuration task</code> message is routed by RabbitMQ to a queue used by <code>Travis Hub</code>. The Hub fetches <code>.travis.yml</code> from project
repository, parses it and checks whether the build has to be skipped. If so, the message is not processed further. If not, then
it publishes one or more <code>build task</code> messages, one per <code>build matrix</code> row.</p>

<h4 id="noon">Noon</h4>

<p><code>Build task</code> messages are routed to one of several queues (depending on project language setting in <code>.travis.yml</code>) and consumed
by one of <code>Travis Workers</code>. <code>Travis Worker</code> that consumed the message then uses information in it to determine how to run the build.
Then it establishes SSH connection to one of snapshotted <code>Travis VMs</code>, picks a <code>technology-specific builder</code> and runs the build.
Build lifecycle is documented in detail in our <a href="/docs/user/build-configuration">Build Configuration guide</a>.</p>

<p>Commands that <code>technology-specific builder</code> runs over SSH produce output (via standard in and standard out streams) that <code>Travis Worker</code>
captures and publishes as <code>build log chunk</code> messages. Those messages are routed by RabbitMQ to one of several queues (one per project
type: Clojure, Node.js, PHP, Ruby, etc). From there, they are pushed to consumers in <code>Travis Hub</code> which <strong>primary purpose is to
collect build logs and process them</strong>.</p>

<p>Build log processing in <code>Travis Hub</code> has multiple steps, some of which have strict ordering requirements and some are executed
asynchronously in separate threads:</p>

<ul>
  <li>Update build log in the database</li>
  <li>Propagate <code>build log chunk</code> messages to Web browsers using WebSockets</li>
  <li>Detect build termination</li>
  <li>On build termination: update build task records, deliver email/IRC/Campfire notifications</li>
</ul>

<p>This is where our single page rich client app that <code>Travis Server</code> serves comes in. It receives propagated event messages via WebSockets
and updates the UI in near real time.</p>

<h4 id="night">Night</h4>

<p>When the build is done (successfully or not), apps prepare to sleep:</p>

<ul>
  <li><code>Travis Hub</code> finalizes build tasks state, propagates <code>build termination event</code> messages to Web browsers, delivers notifications if needed.</li>
  <li><code>Travis Worker</code> powers off and rolls back the VM it had been using to run this build. This wipes any changes to the CI environment so no state is preserved between builds.</li>
</ul>

<p>The End. The system is ready for another build request.</p>

<h2 id="libraries">Libraries</h2>

<p>TBD</p>

<h2 id="vm-images">VM images</h2>

<p>TBD</p>

<h2 id="ci-environment-upgrade-process">CI Environment Upgrade Process</h2>

<p>TBD</p>

<h2 id="dependency-updates-policy">Dependency Updates Policy</h2>

<p>TBD</p>

<h2 id="libraries-1">Libraries</h2>

<p>TBD</p>

<h2 id="what-to-read-next">What To Read Next</h2>

<p>TBD</p>

          </div><!-- /#main -->
          <div id="sidebar">
            <h2>Contact</h2>
            <ul>
              <li><a href="http://github.com/travis-ci">Github</a></li>
              <li><a href="http://twitter.com/travisci">Twitter</a></li>
              <li><a href="irc://irc.freenode.net#travis">IRC</a></li>
              <li><a href="http://groups.google.com/group/travis-ci">Mailing list</a></li>
            </ul>
            <h2>Guides</h2>
            <ul>
              <li><a href="/docs/user/getting-started/">Getting started</a></li>
              <li><a href="/docs/user/build-configuration/">Build configuration</a></li>
              <li><a href="/docs/user/database-setup/">Database setup</a></li>
              <li><a href="/docs/user/selenium-setup/">Selenium setup</a></li>
              <li><a href="/docs/user/status-images/">Status images</a></li>
              <li><a href="/docs/user/resources/">Resources</a></li>
              <li><a href="/docs/user/ci-environment/">CI environment</a></li>
              <li><a href="/docs/user/extensions/">Extensions</a></li>
              <li><a href="/docs/user/how-to-skip-a-build/">How to skip a build</a></li>
              <li><a href="/docs/user/how-to-setup-and-trigger-the-hook-manually/">How to setup and trigger the hook manually</a></li>
            </ul>
            <h2>Language-specific Guides</h2>
            <ul>
            <li><a href="/docs/user/languages/clojure/">Clojure</a></li>
            <li><a href="/docs/user/languages/erlang/">Erlang</a></li>
            <li><a href="/docs/user/languages/javascript-with-nodejs/">JavaScript (with Node.js)</a></li>
            <li><a href="/docs/user/languages/php/">PHP</a></li>
            <li><a href="/docs/user/languages/ruby/">Ruby</a></li>
           </ul>
            <h2>Developer Guides</h2>
            <ul>
              <li><a href="/docs/dev/api/">The API</a></li>
            </ul>
            <h2>Contributor Guides</h2>
            <ul>
              <li><a href="/docs/dev/overview/">Overview</a></li>
              <li><a href="/docs/dev/worker/">The worker (v3)</a></li>
              <li><a href="/docs/dev/build_tasks/">Build Tasks</a></li>
              <li><a href="/docs/dev/maintenance/">Maintenance</a></li>
            </ul>
            <h2>Under construction</h2>
            <ul>
              <li><p>Our site is still <a href="https://github.com/travis-ci/travis-ci.github.com">under construction</a>. You can help us in: travis#irc.freenode.net</p></li>
            </ul>
          </div><!-- /#sidebar -->
        </div><!-- /.pad -->
      </div><!-- /.wrapper -->
    </div><!-- /#content -->

    <div id="footer">
      <div class="wrapper">
        <div class="box">
          <p>This site is maintained by the <a href="http://github.com/travis-ci">Travis CI community</a>. Feel free to <a href="http://github.com/travis-ci/travis-ci.github.com">contribute</a>!</p>
        </div>
        <div class="box">
          <p>This design was kindly provided by the talented Ben Webster of <a href="http://www.plus2.com.au">Plus2</a>.</p>
        </div>
        <div class="box last">
          <ul>
            <li><a href="https://github.com/travis-ci" title="">Travis CI on GitHub</a></li>
            <li><a href="https://twitter.com/travisci" title="">Travis CI on Twitter</a></li>
          </ul>
        </div><!-- /.box -->
      </div><!-- /.wrapper -->
    </div><!-- /#footer -->
  </body>
</html>
